!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 2.2.4 (r2308) - 03/04/2008 10:03
!  
!  Differentiation of extractbcstatesadj in reverse (adjoint) mode:
!   gradient, with respect to input variables: padj0 padj1 padj2
!                padj padj3 wadj wadj0 wadj1 wadj2
!   of linear combination of output variables: padj0 padj1 padj2
!                padj padj3 wadj wadj0 wadj1 wadj2
!
!      ******************************************************************
!      *                                                                *
!      * File:          extractBCStatesAdj.f90                             *
!      * Author:        C.A.(Sandy) Mader                               *
!      * Starting date: 04-16-2008                                      *
!      * Last modified: 04-16-2008                                      *
!      *                                                                *
!      ******************************************************************
!
SUBROUTINE EXTRACTBCSTATESADJ_B(nn, wadj, wadjb, padj, padjb, wadj0, &
&  wadj0b, wadj1, wadj1b, wadj2, wadj2b, wadj3, padj0, padj0b, padj1, &
&  padj1b, padj2, padj2b, padj3, padj3b, rlvadj, revadj, rlvadj1, &
&  rlvadj2, revadj1, revadj2, ioffset, joffset, koffset, icell, jcell, &
&  kcell, isbeg, jsbeg, ksbeg, isend, jsend, ksend, ibbeg, jbbeg, kbbeg&
&  , ibend, jbend, kbend, icbeg, jcbeg, icend, jcend, secondhalo)
  USE blockpointers, ONLY : ie, ib, je, jb, ke, kb, nbocos, bcfaceid, &
&  bctype, bcdata
  USE bctypes
  USE flowvarrefstate
  IMPLICIT NONE
!    end if checkOverlap
!  enddo
!      ******************************************************************
!      *                                                                *
!      * copyBCStatesAdj copies the states needed for the boundary      *
!      * condition treatment on a general face, such that the boundary  *
!      * routines are only implemented once instead of 6 times.         *
!      * This routine takes the place of setBCPointers in the orginal   *
!      * Code                                                           *
!      *                                                                *
!      ******************************************************************
!
!
!      Subroutine arguments.
!
!, offset
  INTEGER(KIND=INTTYPE), INTENT(IN) :: nn
  INTEGER(KIND=INTTYPE), INTENT(IN) :: icell, jcell, kcell
  INTEGER(KIND=INTTYPE), INTENT(IN) :: isbeg, jsbeg, ksbeg, isend, jsend&
&  , ksend
  INTEGER(KIND=INTTYPE), INTENT(IN) :: ibbeg, jbbeg, kbbeg, ibend, jbend&
&  , kbend
  INTEGER(KIND=INTTYPE), INTENT(OUT) :: icbeg, jcbeg, icend, jcend
  INTEGER(KIND=INTTYPE) :: irbeg, jrbeg, krbeg, irend, jrend, krend
  INTEGER(KIND=INTTYPE) :: ioffset, joffset, koffset
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, -2:2, nw) :: wadj
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, -2:2, nw) :: wadjb
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, -2:2) :: padj
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, -2:2) :: padjb
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, nw) :: wadj0, wadj1
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, nw) :: wadj0b, wadj1b
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, nw) :: wadj2, wadj3
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, nw) :: wadj2b
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2) :: padj0, padj1
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2) :: padj0b, padj1b
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2) :: padj2, padj3
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2) :: padj2b, padj3b
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2, -2:2) :: rlvadj, revadj
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2) :: rlvadj1, rlvadj2
  REAL(KIND=REALTYPE), DIMENSION(-2:2, -2:2) :: revadj1, revadj2
  LOGICAL :: ioverlap, joverlap, koverlap
  LOGICAL, INTENT(INOUT) :: secondhalo
  INTRINSIC MAX
  INTRINSIC MIN
  IF (isbeg .LT. ibbeg) THEN
    irbeg = ibbeg
  ELSE
    irbeg = isbeg
  END IF
  IF (isend .GT. ibend) THEN
    irend = ibend
  ELSE
    irend = isend
  END IF
  IF (jsbeg .LT. jbbeg) THEN
    jrbeg = jbbeg
  ELSE
    jrbeg = jsbeg
  END IF
  IF (jsend .GT. jbend) THEN
    jrend = jbend
  ELSE
    jrend = jsend
  END IF
  IF (ksbeg .LT. kbbeg) THEN
    krbeg = kbbeg
  ELSE
    krbeg = ksbeg
  END IF
  IF (ksend .GT. kbend) THEN
    krend = kbend
  ELSE
    krend = ksend
  END IF
! Set some pointers depending on the situation.
  SELECT CASE  (bcfaceid(nn)) 
  CASE (imin) 
    CALL PUSHBOOLEAN(secondhalo)
! Other straightforward stuff.
    secondhalo = .true.
    IF (irbeg .EQ. irend) secondhalo = .false.
    IF (secondhalo) THEN
      padjb(1, -2:2, -2:2) = padjb(1, -2:2, -2:2) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(0, -2:2, -2:2) = padjb(0, -2:2, -2:2) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-1, -2:2, -2:2) = padjb(-1, -2:2, -2:2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      padjb(-2, -2:2, -2:2) = padjb(-2, -2:2, -2:2) + padj0b(-2:2, -2:2)
      padj0b(-2:2, -2:2) = 0.0
      wadjb(0, -2:2, -2:2, 1:nw) = wadjb(0, -2:2, -2:2, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-1, -2:2, -2:2, 1:nw) = wadjb(-1, -2:2, -2:2, 1:nw) + wadj1b&
&        (-2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
      wadjb(-2, -2:2, -2:2, 1:nw) = wadjb(-2, -2:2, -2:2, 1:nw) + wadj0b&
&        (-2:2, -2:2, 1:nw)
      wadj0b(-2:2, -2:2, :) = 0.0
    ELSE
      padjb(0, -2:2, -2:2) = padjb(0, -2:2, -2:2) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-1, -2:2, -2:2) = padjb(-1, -2:2, -2:2) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2, -2:2, -2:2) = padjb(-2, -2:2, -2:2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      wadjb(-1, -2:2, -2:2, 1:nw) = wadjb(-1, -2:2, -2:2, 1:nw) + wadj2b&
&        (-2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2, -2:2, -2:2, 1:nw) = wadjb(-2, -2:2, -2:2, 1:nw) + wadj1b&
&        (-2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
    END IF
    CALL POPBOOLEAN(secondhalo)
  CASE (imax) 
    CALL PUSHBOOLEAN(secondhalo)
! Other straightforward stuff.
    secondhalo = .true.
    IF (irbeg .EQ. irend) secondhalo = .false.
    IF (secondhalo) THEN
      padjb(-1, -2:2, -2:2) = padjb(-1, -2:2, -2:2) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(0, -2:2, -2:2) = padjb(0, -2:2, -2:2) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(1, -2:2, -2:2) = padjb(1, -2:2, -2:2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      padjb(2, -2:2, -2:2) = padjb(2, -2:2, -2:2) + padj0b(-2:2, -2:2)
      padj0b(-2:2, -2:2) = 0.0
      wadjb(0, -2:2, -2:2, 1:nw) = wadjb(0, -2:2, -2:2, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(1, -2:2, -2:2, 1:nw) = wadjb(1, -2:2, -2:2, 1:nw) + wadj1b(-&
&        2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
      wadjb(2, -2:2, -2:2, 1:nw) = wadjb(2, -2:2, -2:2, 1:nw) + wadj0b(-&
&        2:2, -2:2, 1:nw)
      wadj0b(-2:2, -2:2, :) = 0.0
    ELSE
      padjb(0, -2:2, -2:2) = padjb(0, -2:2, -2:2) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(1, -2:2, -2:2) = padjb(1, -2:2, -2:2) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(2, -2:2, -2:2) = padjb(2, -2:2, -2:2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      wadjb(1, -2:2, -2:2, 1:nw) = wadjb(1, -2:2, -2:2, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(2, -2:2, -2:2, 1:nw) = wadjb(2, -2:2, -2:2, 1:nw) + wadj1b(-&
&        2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
    END IF
    CALL POPBOOLEAN(secondhalo)
  CASE (jmin) 
    CALL PUSHBOOLEAN(secondhalo)
! Other straightforward stuff.
    secondhalo = .true.
    IF (jrbeg .EQ. jrend) secondhalo = .false.
    IF (secondhalo) THEN
      padjb(-2:2, 1, -2:2) = padjb(-2:2, 1, -2:2) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-2:2, 0, -2:2) = padjb(-2:2, 0, -2:2) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2:2, -1, -2:2) = padjb(-2:2, -1, -2:2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2, -2:2) = padjb(-2:2, -2, -2:2) + padj0b(-2:2, -2:2)
      padj0b(-2:2, -2:2) = 0.0
      wadjb(-2:2, 0, -2:2, 1:nw) = wadjb(-2:2, 0, -2:2, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -1, -2:2, 1:nw) = wadjb(-2:2, -1, -2:2, 1:nw) + wadj1b&
&        (-2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -2, -2:2, 1:nw) = wadjb(-2:2, -2, -2:2, 1:nw) + wadj0b&
&        (-2:2, -2:2, 1:nw)
      wadj0b(-2:2, -2:2, :) = 0.0
    ELSE
      padjb(-2:2, 0, -2:2) = padjb(-2:2, 0, -2:2) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-2:2, -1, -2:2) = padjb(-2:2, -1, -2:2) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2, -2:2) = padjb(-2:2, -2, -2:2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      wadjb(-2:2, -1, -2:2, 1:nw) = wadjb(-2:2, -1, -2:2, 1:nw) + wadj2b&
&        (-2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -2, -2:2, 1:nw) = wadjb(-2:2, -2, -2:2, 1:nw) + wadj1b&
&        (-2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
    END IF
    CALL POPBOOLEAN(secondhalo)
  CASE (jmax) 
    CALL PUSHBOOLEAN(secondhalo)
! Other straightforward stuff.
    secondhalo = .true.
    IF (jrbeg .EQ. jrend) secondhalo = .false.
    IF (secondhalo) THEN
      padjb(-2:2, -1, -2:2) = padjb(-2:2, -1, -2:2) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-2:2, 0, -2:2) = padjb(-2:2, 0, -2:2) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2:2, 1, -2:2) = padjb(-2:2, 1, -2:2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      padjb(-2:2, 2, -2:2) = padjb(-2:2, 2, -2:2) + padj0b(-2:2, -2:2)
      padj0b(-2:2, -2:2) = 0.0
      wadjb(-2:2, 0, -2:2, 1:nw) = wadjb(-2:2, 0, -2:2, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, 1, -2:2, 1:nw) = wadjb(-2:2, 1, -2:2, 1:nw) + wadj1b(-&
&        2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, 2, -2:2, 1:nw) = wadjb(-2:2, 2, -2:2, 1:nw) + wadj0b(-&
&        2:2, -2:2, 1:nw)
      wadj0b(-2:2, -2:2, :) = 0.0
    ELSE
      padjb(-2:2, 0, -2:2) = padjb(-2:2, 0, -2:2) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-2:2, 1, -2:2) = padjb(-2:2, 1, -2:2) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2:2, 2, -2:2) = padjb(-2:2, 2, -2:2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      wadjb(-2:2, 1, -2:2, 1:nw) = wadjb(-2:2, 1, -2:2, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, 2, -2:2, 1:nw) = wadjb(-2:2, 2, -2:2, 1:nw) + wadj1b(-&
&        2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
    END IF
    CALL POPBOOLEAN(secondhalo)
  CASE (kmin) 
    CALL PUSHBOOLEAN(secondhalo)
! Other straightforward stuff.
    secondhalo = .true.
    IF (krbeg .EQ. krend) secondhalo = .false.
    IF (secondhalo) THEN
      padjb(-2:2, -2:2, 1) = padjb(-2:2, -2:2, 1) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, 0) = padjb(-2:2, -2:2, 0) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, -1) = padjb(-2:2, -2:2, -1) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, -2) = padjb(-2:2, -2:2, -2) + padj0b(-2:2, -2:2)
      padj0b(-2:2, -2:2) = 0.0
      wadjb(-2:2, -2:2, 0, 1:nw) = wadjb(-2:2, -2:2, 0, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -2:2, -1, 1:nw) = wadjb(-2:2, -2:2, -1, 1:nw) + wadj1b&
&        (-2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -2:2, -2, 1:nw) = wadjb(-2:2, -2:2, -2, 1:nw) + wadj0b&
&        (-2:2, -2:2, 1:nw)
      wadj0b(-2:2, -2:2, :) = 0.0
    ELSE
      padjb(-2:2, -2:2, 0) = padjb(-2:2, -2:2, 0) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, -1) = padjb(-2:2, -2:2, -1) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, -2) = padjb(-2:2, -2:2, -2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      wadjb(-2:2, -2:2, -1, 1:nw) = wadjb(-2:2, -2:2, -1, 1:nw) + wadj2b&
&        (-2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -2:2, -2, 1:nw) = wadjb(-2:2, -2:2, -2, 1:nw) + wadj1b&
&        (-2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
    END IF
    CALL POPBOOLEAN(secondhalo)
  CASE (kmax) 
    CALL PUSHBOOLEAN(secondhalo)
! Other straightforward stuff.
    secondhalo = .true.
    IF (krbeg .EQ. krend) secondhalo = .false.
    IF (secondhalo) THEN
      padjb(-2:2, -2:2, -1) = padjb(-2:2, -2:2, -1) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, 0) = padjb(-2:2, -2:2, 0) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, 1) = padjb(-2:2, -2:2, 1) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, 2) = padjb(-2:2, -2:2, 2) + padj0b(-2:2, -2:2)
      padj0b(-2:2, -2:2) = 0.0
      wadjb(-2:2, -2:2, 0, 1:nw) = wadjb(-2:2, -2:2, 0, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -2:2, 1, 1:nw) = wadjb(-2:2, -2:2, 1, 1:nw) + wadj1b(-&
&        2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -2:2, 2, 1:nw) = wadjb(-2:2, -2:2, 2, 1:nw) + wadj0b(-&
&        2:2, -2:2, 1:nw)
      wadj0b(-2:2, -2:2, :) = 0.0
    ELSE
      padjb(-2:2, -2:2, 0) = padjb(-2:2, -2:2, 0) + padj3b(-2:2, -2:2)
      padj3b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, 1) = padjb(-2:2, -2:2, 1) + padj2b(-2:2, -2:2)
      padj2b(-2:2, -2:2) = 0.0
      padjb(-2:2, -2:2, 2) = padjb(-2:2, -2:2, 2) + padj1b(-2:2, -2:2)
      padj1b(-2:2, -2:2) = 0.0
      wadjb(-2:2, -2:2, 1, 1:nw) = wadjb(-2:2, -2:2, 1, 1:nw) + wadj2b(-&
&        2:2, -2:2, 1:nw)
      wadj2b(-2:2, -2:2, :) = 0.0
      wadjb(-2:2, -2:2, 2, 1:nw) = wadjb(-2:2, -2:2, 2, 1:nw) + wadj1b(-&
&        2:2, -2:2, 1:nw)
      wadj1b(-2:2, -2:2, :) = 0.0
    END IF
    CALL POPBOOLEAN(secondhalo)
  END SELECT
END SUBROUTINE EXTRACTBCSTATESADJ_B
