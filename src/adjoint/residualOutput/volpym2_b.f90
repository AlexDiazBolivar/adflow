!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 2.2.4 (r2308) - 03/04/2008 10:03
!  
!  Differentiation of volpym2 in reverse (adjoint) mode:
!   gradient, with respect to input variables: xa xb xc xd xp ya
!                yb yc yd yp za zb zc zd zp
!   of linear combination of output variables: xa xb xc xd xp ya
!                yb yc yd yp vp za zb zc zd zp
!      ==================================================================
!      ================================================================
SUBROUTINE VOLPYM2_B(xa, xab, ya, yab, za, zab, xb, xbb, yb, ybb, zb, &
&  zbb, xc, xcb, yc, ycb, zc, zcb, xd, xdb, yd, ydb, zd, zdb, xp, xpb, &
&  yp, ypb, zp, zpb, vp, vpb)
  USE precision
  USE constants
  IMPLICIT NONE
!
!        ****************************************************************
!        *                                                              *
!        * volpym computes 6 times the volume of a pyramid. Node p,     *
!        * whose coordinates are set in the subroutine metric itself,   *
!        * is the top node and a-b-c-d is the quadrilateral surface.    *
!        * It is assumed that the cross product vCa * vDb points in     *
!        * the direction of the top node. Here vCa is the diagonal      *
!        * running from node c to node a and vDb the diagonal from      *
!        * node d to node b.                                            *
!        *                                                              *
!        ****************************************************************
!
!
!        Subroutine arguments.
!
  REAL(KIND=REALTYPE) :: xa, ya, za, xb, yb, zb
  REAL(KIND=REALTYPE) :: xab, yab, zab, xbb, ybb, zbb
  REAL(KIND=REALTYPE) :: xc, yc, zc, xd, yd, zd
  REAL(KIND=REALTYPE) :: xcb, ycb, zcb, xdb, ydb, zdb
  REAL(KIND=REALTYPE) :: xp, yp, zp
  REAL(KIND=REALTYPE) :: xpb, ypb, zpb
  REAL(KIND=REALTYPE) :: vp
!
!        ****************************************************************
!        *                                                              *
!        * Begin execution                                              *
!        *                                                              *
!        ****************************************************************
!
  REAL(KIND=REALTYPE) :: vpb
  REAL(KIND=REALTYPE) :: tempb7
  REAL(KIND=REALTYPE) :: tempb6
  REAL(KIND=REALTYPE) :: tempb5
  REAL(KIND=REALTYPE) :: tempb4
  REAL(KIND=REALTYPE) :: tempb3
  REAL(KIND=REALTYPE) :: tempb2
  REAL(KIND=REALTYPE) :: tempb1
  REAL(KIND=REALTYPE) :: tempb0
  REAL(KIND=REALTYPE) :: tempb
  tempb = ((ya-yc)*(zb-zd)-(za-zc)*(yb-yd))*vpb
  tempb0 = -(fourth*tempb)
  tempb1 = (xp-fourth*(xa+xb+xc+xd))*vpb
  tempb2 = ((za-zc)*(xb-xd)-(xa-xc)*(zb-zd))*vpb
  tempb3 = -(fourth*tempb2)
  tempb4 = (yp-fourth*(ya+yb+yc+yd))*vpb
  tempb5 = ((xa-xc)*(yb-yd)-(ya-yc)*(xb-xd))*vpb
  tempb6 = -(fourth*tempb5)
  tempb7 = (zp-fourth*(za+zb+zc+zd))*vpb
  xpb = xpb + tempb
  xab = xab + (yb-yd)*tempb7 - (zb-zd)*tempb4 + tempb0
  xbb = xbb + (za-zc)*tempb4 - (ya-yc)*tempb7 + tempb0
  xcb = xcb + (zb-zd)*tempb4 - (yb-yd)*tempb7 + tempb0
  xdb = xdb + (ya-yc)*tempb7 - (za-zc)*tempb4 + tempb0
  yab = yab + tempb3 - (xb-xd)*tempb7 + (zb-zd)*tempb1
  ycb = ycb + (xb-xd)*tempb7 + tempb3 - (zb-zd)*tempb1
  zbb = zbb + tempb6 - (xa-xc)*tempb4 + (ya-yc)*tempb1
  zdb = zdb + tempb6 + (xa-xc)*tempb4 - (ya-yc)*tempb1
  zab = zab + tempb6 + (xb-xd)*tempb4 - (yb-yd)*tempb1
  zcb = zcb + tempb6 - (xb-xd)*tempb4 + (yb-yd)*tempb1
  ybb = ybb + (xa-xc)*tempb7 + tempb3 - (za-zc)*tempb1
  ydb = ydb + tempb3 - (xa-xc)*tempb7 + (za-zc)*tempb1
  ypb = ypb + tempb2
  zpb = zpb + tempb5
END SUBROUTINE VOLPYM2_B
